package arch

import (
	uc "github.com/unicorn-engine/unicorn/bindings/go/unicorn"
)

type ArchX86_64 struct {}

func (s *ArchX86_64) GetRegisters()[]int {return regs_by_index_x86_64 }
func (s *ArchX86_64) GetRegStack() int {return uc.X86_REG_RSP}
func (s *ArchX86_64) GetRegIP() int {return uc.X86_REG_RIP}
func (s *ArchX86_64) GetRegStackBase() int {return uc.X86_REG_RBP}
func (s *ArchX86_64) GetRegRet() int {return uc.X86_REG_RAX}
func (s *ArchX86_64) ToUnicornArchDescription() int {return uc.ARCH_X86}
func (s *ArchX86_64) ToUnicornModeDescription() int {return uc.MODE_64}

func (s *ArchX86_64) IsRet(mem []byte) bool {
	if mem[0] == 0xc3 {
		return true
	}
	if (mem[0] == 0xf2 || mem[0] == 0xf3) && mem[1] == 0xc3 {
		return true
	}
	return false
}

var regs_by_index_x86_64 = []int{
	uc.X86_REG_RAX, 
	uc.X86_REG_RBX, 
	uc.X86_REG_RCX, 
	uc.X86_REG_RDX, 
	uc.X86_REG_RDI, 
	uc.X86_REG_RIP, 
	uc.X86_REG_RIZ, 
	uc.X86_REG_RSI, 
	uc.X86_REG_RSP, 
	uc.X86_REG_RBP, 
	uc.X86_REG_FS ,
	uc.X86_REG_GS ,
	uc.X86_REG_SI ,
	uc.X86_REG_SIL, 
	uc.X86_REG_SP ,
	uc.X86_REG_SPL, 
	uc.X86_REG_SS ,
	uc.X86_REG_CR0, 
	uc.X86_REG_CR1, 
	uc.X86_REG_CR2, 
	uc.X86_REG_CR3, 
	uc.X86_REG_CR4, 
	uc.X86_REG_CR5, 
	uc.X86_REG_CR6, 
	uc.X86_REG_CR7, 
	uc.X86_REG_CR8, 
	uc.X86_REG_CR9, 
	uc.X86_REG_CR10,
	uc.X86_REG_CR11, 
	uc.X86_REG_CR12, 
	uc.X86_REG_CR13, 
	uc.X86_REG_CR14, 
	uc.X86_REG_CR15,
	uc.X86_REG_DR0 ,
	uc.X86_REG_DR1 ,
	uc.X86_REG_DR2 ,
	uc.X86_REG_DR3 ,
	uc.X86_REG_DR4 ,
	uc.X86_REG_DR5 ,
	uc.X86_REG_DR6 ,
	uc.X86_REG_DR7 ,
	uc.X86_REG_DR8 ,
	uc.X86_REG_DR9 ,
	uc.X86_REG_DR10, 
	uc.X86_REG_DR11, 
	uc.X86_REG_DR12, 
	uc.X86_REG_DR13, 
	uc.X86_REG_DR14, 
	uc.X86_REG_DR15, 
	uc.X86_REG_FP0 ,
	uc.X86_REG_FP1 ,
	uc.X86_REG_FP2 ,
	uc.X86_REG_FP3 ,
	uc.X86_REG_FP4 ,
	uc.X86_REG_FP5 ,
	uc.X86_REG_FP6 ,
	uc.X86_REG_FP7 ,
	uc.X86_REG_K0 ,
	uc.X86_REG_K1, 
	uc.X86_REG_K2, 
	uc.X86_REG_K3, 
	uc.X86_REG_K4, 
	uc.X86_REG_K5, 
	uc.X86_REG_K6, 
	uc.X86_REG_K7, 
	uc.X86_REG_MM0 ,
	uc.X86_REG_MM1 ,
	uc.X86_REG_MM2 ,
	uc.X86_REG_MM3 ,
	uc.X86_REG_MM4 ,
	uc.X86_REG_MM5 ,
	uc.X86_REG_MM6 ,
	uc.X86_REG_MM7 ,
	uc.X86_REG_R8, 
	uc.X86_REG_R9, 
	uc.X86_REG_R10 ,
	uc.X86_REG_R11 ,
	uc.X86_REG_R12 ,
	uc.X86_REG_R13 ,
	uc.X86_REG_R14 ,
	uc.X86_REG_R15 ,
	uc.X86_REG_ST0 ,
	uc.X86_REG_ST1 ,
	uc.X86_REG_ST2 ,
	uc.X86_REG_ST3 ,
	uc.X86_REG_ST4 ,
	uc.X86_REG_ST5 ,
	uc.X86_REG_ST6 ,
	uc.X86_REG_ST7 ,
	uc.X86_REG_XMM0, 
	uc.X86_REG_XMM1, 
	uc.X86_REG_XMM2, 
	uc.X86_REG_XMM3, 
	uc.X86_REG_XMM4, 
	uc.X86_REG_XMM5, 
	uc.X86_REG_XMM6, 
	uc.X86_REG_XMM7, 
	uc.X86_REG_XMM8, 
	uc.X86_REG_XMM9, 
	uc.X86_REG_XMM10, 
	uc.X86_REG_XMM11, 
	uc.X86_REG_XMM12, 
	uc.X86_REG_XMM13, 
	uc.X86_REG_XMM14, 
	uc.X86_REG_XMM15, 
	uc.X86_REG_XMM16, 
	uc.X86_REG_XMM17, 
	uc.X86_REG_XMM18, 
	uc.X86_REG_XMM19, 
	uc.X86_REG_XMM20, 
	uc.X86_REG_XMM21, 
	uc.X86_REG_XMM22, 
	uc.X86_REG_XMM23, 
	uc.X86_REG_XMM24, 
	uc.X86_REG_XMM25, 
	uc.X86_REG_XMM26, 
	uc.X86_REG_XMM27, 
	uc.X86_REG_XMM28, 
	uc.X86_REG_XMM29, 
	uc.X86_REG_XMM30, 
	uc.X86_REG_XMM31, 
	uc.X86_REG_YMM0 ,
	uc.X86_REG_YMM1 ,
	uc.X86_REG_YMM2 ,
	uc.X86_REG_YMM3 ,
	uc.X86_REG_YMM4 ,
	uc.X86_REG_YMM5 ,
	uc.X86_REG_YMM6 ,
	uc.X86_REG_YMM7 ,
	uc.X86_REG_YMM8 ,
	uc.X86_REG_YMM9 ,
	uc.X86_REG_YMM10, 
	uc.X86_REG_YMM11, 
	uc.X86_REG_YMM12, 
	uc.X86_REG_YMM13, 
	uc.X86_REG_YMM14, 
	uc.X86_REG_YMM15, 
	uc.X86_REG_YMM16, 
	uc.X86_REG_YMM17, 
	uc.X86_REG_YMM18, 
	uc.X86_REG_YMM19, 
	uc.X86_REG_YMM20, 
	uc.X86_REG_YMM21, 
	uc.X86_REG_YMM22, 
	uc.X86_REG_YMM23, 
	uc.X86_REG_YMM24, 
	uc.X86_REG_YMM25, 
	uc.X86_REG_YMM26, 
	uc.X86_REG_YMM27, 
	uc.X86_REG_YMM28, 
	uc.X86_REG_YMM29, 
	uc.X86_REG_YMM30, 
	uc.X86_REG_YMM31, 
	uc.X86_REG_ZMM0 ,
	uc.X86_REG_ZMM1 ,
	uc.X86_REG_ZMM2 ,
	uc.X86_REG_ZMM3 ,
	uc.X86_REG_ZMM4 ,
	uc.X86_REG_ZMM5 ,
	uc.X86_REG_ZMM6 ,
	uc.X86_REG_ZMM7 ,
	uc.X86_REG_ZMM8 ,
	uc.X86_REG_ZMM9 ,
	uc.X86_REG_ZMM10, 
	uc.X86_REG_ZMM11, 
	uc.X86_REG_ZMM12, 
	uc.X86_REG_ZMM13, 
	uc.X86_REG_ZMM14, 
	uc.X86_REG_ZMM15, 
	uc.X86_REG_ZMM16, 
	uc.X86_REG_ZMM17, 
	uc.X86_REG_ZMM18, 
	uc.X86_REG_ZMM19, 
	uc.X86_REG_ZMM20, 
	uc.X86_REG_ZMM21, 
	uc.X86_REG_ZMM22, 
	uc.X86_REG_ZMM23, 
	uc.X86_REG_ZMM24, 
	uc.X86_REG_ZMM25, 
	uc.X86_REG_ZMM26, 
	uc.X86_REG_ZMM27, 
	uc.X86_REG_ZMM28, 
	uc.X86_REG_ZMM29, 
	uc.X86_REG_ZMM30, 
	uc.X86_REG_ZMM31, 
	uc.X86_REG_R8B  ,
	uc.X86_REG_R9B  , 
	uc.X86_REG_R10B ,
	uc.X86_REG_R11B ,
	uc.X86_REG_R12B ,
	uc.X86_REG_R13B ,
	uc.X86_REG_R14B ,
	uc.X86_REG_R15B ,
	uc.X86_REG_R8D ,
	uc.X86_REG_R9D ,
	uc.X86_REG_R10D ,
	uc.X86_REG_R11D ,
	uc.X86_REG_R12D ,
	uc.X86_REG_R13D ,
	uc.X86_REG_R14D ,
	uc.X86_REG_R15D ,
	uc.X86_REG_R8W  ,
	uc.X86_REG_R9W  , 
	uc.X86_REG_R10W ,
	uc.X86_REG_R11W ,
	uc.X86_REG_R12W ,
	uc.X86_REG_R13W ,
	uc.X86_REG_R14W ,
	uc.X86_REG_R15W ,
}
